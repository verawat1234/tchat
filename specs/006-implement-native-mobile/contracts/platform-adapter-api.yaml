openapi: 3.0.3
info:
  title: Platform Adapter API
  description: Platform-specific behavior adaptation for cross-platform mobile UI consistency
  version: 1.0.0
  contact:
    name: Tchat Mobile Platform Team

servers:
  - url: https://api.tchat.app/v1
    description: Production API
  - url: https://staging-api.tchat.app/v1
    description: Staging API

paths:
  /platform/capabilities:
    get:
      summary: Get platform capabilities
      description: Retrieve available platform-specific capabilities and features
      parameters:
        - name: platform
          in: query
          required: true
          schema:
            type: string
            enum: [ios, android]
          description: Target platform
        - name: version
          in: query
          schema:
            type: string
          description: Platform OS version (optional)
      responses:
        '200':
          description: Platform capabilities retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlatformCapabilities'
        '400':
          $ref: '#/components/responses/BadRequest'

  /platform/gestures/config:
    get:
      summary: Get gesture configuration
      description: Retrieve platform-specific gesture recognition configuration
      parameters:
        - name: platform
          in: query
          required: true
          schema:
            type: string
            enum: [ios, android]
          description: Target platform
        - name: component_type
          in: query
          schema:
            type: string
          description: Specific component type for gesture config
      responses:
        '200':
          description: Gesture configuration retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GestureConfiguration'
        '400':
          $ref: '#/components/responses/BadRequest'

    post:
      summary: Update gesture configuration
      description: Update platform-specific gesture recognition settings
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GestureConfigUpdate'
      responses:
        '200':
          description: Gesture configuration updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConfigUpdateResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'

  /platform/animations/presets:
    get:
      summary: Get animation presets
      description: Retrieve platform-appropriate animation configurations
      parameters:
        - name: platform
          in: query
          required: true
          schema:
            type: string
            enum: [ios, android]
          description: Target platform
        - name: animation_type
          in: query
          schema:
            type: string
            enum: [transition, spring, timing, gesture]
          description: Type of animation presets to retrieve
      responses:
        '200':
          description: Animation presets retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AnimationPresets'
        '400':
          $ref: '#/components/responses/BadRequest'

  /platform/accessibility/mapping:
    get:
      summary: Get accessibility mapping
      description: Retrieve platform-specific accessibility feature mappings
      parameters:
        - name: platform
          in: query
          required: true
          schema:
            type: string
            enum: [ios, android]
          description: Target platform
        - name: feature_type
          in: query
          schema:
            type: string
            enum: [screen_reader, voice_control, switch_control, gesture_navigation]
          description: Specific accessibility feature type
      responses:
        '200':
          description: Accessibility mapping retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AccessibilityMapping'
        '400':
          $ref: '#/components/responses/BadRequest'

  /platform/performance/settings:
    get:
      summary: Get performance settings
      description: Retrieve platform-specific performance optimization settings
      parameters:
        - name: platform
          in: query
          required: true
          schema:
            type: string
            enum: [ios, android]
          description: Target platform
        - name: device_class
          in: query
          schema:
            type: string
            enum: [low_end, mid_range, high_end, unknown]
          description: Device performance class
      responses:
        '200':
          description: Performance settings retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PerformanceSettings'
        '400':
          $ref: '#/components/responses/BadRequest'

    post:
      summary: Update performance settings
      description: Update platform-specific performance optimization settings
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PerformanceSettingsUpdate'
      responses:
        '200':
          description: Performance settings updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConfigUpdateResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'

components:
  schemas:
    PlatformCapabilities:
      type: object
      properties:
        platform:
          type: string
          enum: [ios, android]
          description: Platform identifier
        os_version:
          type: string
          description: Operating system version
        device_type:
          type: string
          enum: [phone, tablet, watch, tv]
          description: Device type
        ui_framework:
          type: string
          enum: [swiftui, uikit, compose, views]
          description: Available UI framework
        navigation_capabilities:
          type: object
          properties:
            supports_stack_navigation:
              type: boolean
            supports_tab_navigation:
              type: boolean
            supports_modal_presentation:
              type: boolean
            supports_drawer_navigation:
              type: boolean
            supports_split_view:
              type: boolean
            supports_page_view:
              type: boolean
          description: Navigation system capabilities
        gesture_capabilities:
          type: object
          properties:
            supports_swipe_gestures:
              type: boolean
            supports_pinch_zoom:
              type: boolean
            supports_long_press:
              type: boolean
            supports_force_touch:
              type: boolean
            supports_edge_swipe:
              type: boolean
            supports_multi_touch:
              type: boolean
          description: Gesture recognition capabilities
        animation_capabilities:
          type: object
          properties:
            supports_spring_animations:
              type: boolean
            supports_keyframe_animations:
              type: boolean
            supports_physics_animations:
              type: boolean
            supports_shared_element_transitions:
              type: boolean
            max_concurrent_animations:
              type: integer
          description: Animation system capabilities
        accessibility_capabilities:
          type: object
          properties:
            supports_screen_reader:
              type: boolean
            supports_voice_control:
              type: boolean
            supports_switch_control:
              type: boolean
            supports_high_contrast:
              type: boolean
            supports_dynamic_type:
              type: boolean
            supports_reduce_motion:
              type: boolean
          description: Accessibility feature capabilities
      required: [platform, os_version, device_type, ui_framework]

    GestureConfiguration:
      type: object
      properties:
        platform:
          type: string
          enum: [ios, android]
          description: Platform identifier
        gesture_types:
          type: object
          additionalProperties:
            type: object
            properties:
              enabled:
                type: boolean
              sensitivity:
                type: number
                minimum: 0.0
                maximum: 1.0
              threshold:
                type: number
              delay:
                type: number
              simultaneous_recognition:
                type: boolean
              requires_failure_of:
                type: array
                items:
                  type: string
              priority:
                type: integer
            required: [enabled]
          description: Configuration for each gesture type
        component_overrides:
          type: object
          additionalProperties:
            type: object
            additionalProperties: true
          description: Component-specific gesture overrides
        accessibility_adjustments:
          type: object
          properties:
            reduced_motion_override:
              type: boolean
            increased_touch_tolerance:
              type: boolean
            voice_control_compatibility:
              type: boolean
          description: Accessibility-related gesture adjustments
        performance_settings:
          type: object
          properties:
            gesture_recognition_frequency:
              type: number
            batch_gesture_updates:
              type: boolean
            debounce_threshold:
              type: number
          description: Performance optimization settings
      required: [platform, gesture_types]

    GestureConfigUpdate:
      type: object
      properties:
        platform:
          type: string
          enum: [ios, android]
          description: Platform identifier
        user_id:
          type: string
          description: User identifier
        configuration:
          $ref: '#/components/schemas/GestureConfiguration'
        timestamp:
          type: string
          format: date-time
          description: Update timestamp
      required: [platform, user_id, configuration, timestamp]

    AnimationPresets:
      type: object
      properties:
        platform:
          type: string
          enum: [ios, android]
          description: Platform identifier
        transition_presets:
          type: object
          additionalProperties:
            type: object
            properties:
              duration:
                type: number
              timing_function:
                type: string
                enum: [linear, ease, ease_in, ease_out, ease_in_out, spring]
              spring_damping:
                type: number
                minimum: 0.0
                maximum: 1.0
              spring_stiffness:
                type: number
              delay:
                type: number
              auto_reverse:
                type: boolean
              repeat_count:
                type: integer
            required: [duration, timing_function]
          description: Transition animation presets
        spring_presets:
          type: object
          additionalProperties:
            type: object
            properties:
              damping:
                type: number
              stiffness:
                type: number
              mass:
                type: number
              initial_velocity:
                type: number
              allow_overdamping:
                type: boolean
            required: [damping, stiffness]
          description: Spring animation presets
        gesture_driven_presets:
          type: object
          additionalProperties:
            type: object
            properties:
              follows_finger:
                type: boolean
              momentum_decay:
                type: number
              bounce_back:
                type: boolean
              rubber_band_effect:
                type: boolean
              velocity_threshold:
                type: number
            required: [follows_finger]
          description: Gesture-driven animation presets
        accessibility_overrides:
          type: object
          properties:
            reduce_motion_duration_multiplier:
              type: number
            disable_spring_animations:
              type: boolean
            simplified_transitions:
              type: boolean
          description: Accessibility animation overrides
      required: [platform, transition_presets]

    AccessibilityMapping:
      type: object
      properties:
        platform:
          type: string
          enum: [ios, android]
          description: Platform identifier
        screen_reader_mapping:
          type: object
          properties:
            element_types:
              type: object
              additionalProperties:
                type: object
                properties:
                  default_trait:
                    type: string
                  action_mappings:
                    type: object
                    additionalProperties:
                      type: string
                  value_format:
                    type: string
                required: [default_trait]
            navigation_patterns:
              type: object
              additionalProperties:
                type: object
                properties:
                  focus_order:
                    type: array
                    items:
                      type: string
                  skip_elements:
                    type: array
                    items:
                      type: string
                  grouping_strategy:
                    type: string
                    enum: [none, container, landmark, custom]
                required: [focus_order]
          description: Screen reader feature mapping
        voice_control_mapping:
          type: object
          properties:
            command_mappings:
              type: object
              additionalProperties:
                type: object
                properties:
                  voice_commands:
                    type: array
                    items:
                      type: string
                  action:
                    type: string
                  parameters:
                    type: object
                    additionalProperties: true
                required: [voice_commands, action]
            number_overlay_config:
              type: object
              properties:
                enabled:
                  type: boolean
                show_for_components:
                  type: array
                  items:
                    type: string
                numbering_strategy:
                  type: string
                  enum: [sequential, grouped, custom]
              required: [enabled]
          description: Voice control feature mapping
        switch_control_mapping:
          type: object
          properties:
            scanning_config:
              type: object
              properties:
                scan_pattern:
                  type: string
                  enum: [linear, group, custom]
                scan_speed:
                  type: number
                auto_scanning:
                  type: boolean
                repeat_scanning:
                  type: boolean
              required: [scan_pattern]
            switch_actions:
              type: object
              additionalProperties:
                type: object
                properties:
                  action_type:
                    type: string
                    enum: [select, move_next, move_previous, activate, custom]
                  timing:
                    type: object
                    properties:
                      press_duration:
                        type: number
                      repeat_interval:
                        type: number
                    required: [press_duration]
                required: [action_type]
          description: Switch control feature mapping
      required: [platform]

    PerformanceSettings:
      type: object
      properties:
        platform:
          type: string
          enum: [ios, android]
          description: Platform identifier
        device_class:
          type: string
          enum: [low_end, mid_range, high_end, unknown]
          description: Device performance class
        rendering_settings:
          type: object
          properties:
            frame_rate_target:
              type: integer
              enum: [30, 60, 120]
            enable_vsync:
              type: boolean
            gpu_acceleration:
              type: boolean
            texture_compression:
              type: boolean
            shadow_quality:
              type: string
              enum: [disabled, low, medium, high]
          required: [frame_rate_target, enable_vsync]
        memory_settings:
          type: object
          properties:
            cache_size_limit:
              type: integer
              description: Cache size limit in MB
            image_cache_policy:
              type: string
              enum: [aggressive, balanced, conservative]
            view_recycling:
              type: boolean
            background_processing_limit:
              type: integer
          required: [cache_size_limit, view_recycling]
        animation_settings:
          type: object
          properties:
            max_concurrent_animations:
              type: integer
            animation_quality:
              type: string
              enum: [low, medium, high]
            enable_hardware_acceleration:
              type: boolean
            reduce_layer_effects:
              type: boolean
          required: [max_concurrent_animations, animation_quality]
        network_settings:
          type: object
          properties:
            request_timeout:
              type: integer
              description: Network request timeout in milliseconds
            max_concurrent_requests:
              type: integer
            enable_request_caching:
              type: boolean
            prefetch_strategy:
              type: string
              enum: [none, predictive, aggressive]
          required: [request_timeout, max_concurrent_requests]
        battery_optimization:
          type: object
          properties:
            background_refresh_limit:
              type: boolean
            location_accuracy:
              type: string
              enum: [precise, approximate, disabled]
            haptic_feedback_intensity:
              type: string
              enum: [disabled, light, medium, strong]
          required: [background_refresh_limit]
      required: [platform, device_class, rendering_settings, memory_settings]

    PerformanceSettingsUpdate:
      type: object
      properties:
        platform:
          type: string
          enum: [ios, android]
          description: Platform identifier
        user_id:
          type: string
          description: User identifier
        settings:
          $ref: '#/components/schemas/PerformanceSettings'
        timestamp:
          type: string
          format: date-time
          description: Update timestamp
      required: [platform, user_id, settings, timestamp]

    ConfigUpdateResponse:
      type: object
      properties:
        success:
          type: boolean
          description: Update success status
        updated_config:
          type: object
          additionalProperties: true
          description: Updated configuration
        validation_errors:
          type: array
          items:
            type: object
            properties:
              field:
                type: string
              message:
                type: string
            required: [field, message]
          description: Configuration validation errors
        timestamp:
          type: string
          format: date-time
          description: Server update timestamp
      required: [success, timestamp]

    Error:
      type: object
      properties:
        code:
          type: string
          description: Error code
        message:
          type: string
          description: Human-readable error message
        details:
          type: object
          additionalProperties: true
          description: Additional error details
      required: [code, message]

  responses:
    BadRequest:
      description: Invalid request data
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'

    Unauthorized:
      description: Authentication required
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'

  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

security:
  - BearerAuth: []